(this["webpackJsonpreact-chat"]=this["webpackJsonpreact-chat"]||[]).push([[0],{50:function(e,t,a){},79:function(e,t,a){},80:function(e,t,a){"use strict";a.r(t);var s=a(2),n=a.n(s),r=a(43),c=a.n(r),i=(a(50),a(15)),l=a(16),o=a(18),u=a(17),h=a(22),d=a(32),j=a(25);a(51),a(53);j.a.initializeApp({apiKey:"AIzaSyADdW9WsBiwihH4ToCdbLVBELIRBrKTBP8",authDomain:"chatty-b51b5.firebaseapp.com",databaseURL:"https://chatty-b51b5-default-rtdb.firebaseio.com/"});var b=j.a.auth,m=j.a.database(),p=j.a.database,f=a(6),g=a(9),v=a(1);var x=function(e){var t=e.user_id;return Object(v.jsx)("header",{children:Object(v.jsxs)("nav",{className:"navbar navbar-expand-sm fixed-top navbar-light bg-light",children:[Object(v.jsx)(g.b,{className:"navbar-brand",to:"/",children:"Chatty"}),Object(v.jsx)("button",{className:"navbar-toggler",type:"button","data-toggle":"collapse","data-target":"#navbarNavAltMarkup","aria-controls":"navbarNavAltMarkup","aria-expanded":"false","aria-label":"Toggle navigation",children:Object(v.jsx)("span",{className:"navbar-toggler-icon"})}),Object(v.jsx)("div",{className:"collapse navbar-collapse justify-content-end",id:"navbarNavAltMarkup",children:b().currentUser?Object(v.jsxs)("div",{className:"navbar-nav",children:[Object(v.jsx)(g.b,{className:"nav-item nav-link mr-3",to:"/chat",children:"Profile"}),Object(v.jsx)("button",{className:"btn btn-primary mr-3",onClick:function(){var e=m.ref("users").child(t);e.child("logged").set(!1),e.child("last_online").onDisconnect().set(p.ServerValue.TIMESTAMP),b().signOut()},children:"Logout"}),Object(v.jsx)("button",{className:"btn btn-primary mr-3",onClick:function(){b().currentUser.delete().then((function(){})).catch((function(e){console.log(e)}))},children:"Remove"})]}):Object(v.jsxs)("div",{className:"navbar-nav",children:[Object(v.jsx)(g.b,{className:"nav-item nav-link mr-3",to:"/login",children:"Sign In"}),Object(v.jsx)(g.b,{className:"nav-item nav-link mr-3",to:"/signup",children:"Sign Up"})]})})]})})};var O=function(){return Object(v.jsx)("footer",{className:"pt-5",children:Object(v.jsx)("div",{className:"container text-center",children:Object(v.jsx)("p",{children:"\xa9 Chatty 2020."})})})},_=function(e){Object(o.a)(a,e);var t=Object(u.a)(a);function a(){return Object(i.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){return Object(v.jsxs)("div",{className:"home",children:[Object(v.jsx)(x,{}),Object(v.jsx)("section",{children:Object(v.jsx)("div",{className:"jumbotron jumbotron-fluid py-5",children:Object(v.jsxs)("div",{className:"container text-center py-5",children:[Object(v.jsx)("h1",{className:"display-4",children:"Welcome to Chatty"}),Object(v.jsx)("p",{className:"lead",children:"A great place to share your thoughts with friends"}),Object(v.jsxs)("div",{className:"mt-4",children:[Object(v.jsx)(g.b,{className:"btn btn-primary px-5 mr-3",to:"/signup",children:"Create New Account"}),Object(v.jsx)(g.b,{className:"btn px-5",to:"/login",children:"Login to Your Account"})]})]})})}),Object(v.jsx)(O,{})]})}}]),a}(s.Component),N=a(5),y=a.n(N),S=a(12),k=a(8);var w=a(45),C=a.n(w);var F=a(26),I=a.n(F);function E(e){var t=m.ref("users").child(e);t&&m.ref(".info/connected").on("value",(function(e){!0===e.val()&&(t.child("logged").set(!0),t.child("logged").onDisconnect().set(!1),t.child("last_online").onDisconnect().set(p.ServerValue.TIMESTAMP))}))}function A(e){m.ref("users").once("child_changed",(function(t){var a=t.val(),s=t.key;e.state.listUser.forEach((function(t){t.user_id==s&&(t.logged=a.logged,A(e))})),e.setState({listUser:e.state.listUser})}))}function U(e){m.ref("chats").on("child_added",(function(t){e.loadApp(!1)}))}var D=function(e){Object(o.a)(a,e);var t=Object(u.a)(a);function a(e){var s;return Object(i.a)(this,a),(s=t.call(this,e))._isMounted=!1,s.state={user:s.props.user,conver_user:{},chats:[],users:[],listUser:[],content:"",search:"",readError:null,writeError:null,loadingChats:!1,processing:0,listFile:[]},s.handleChange=s.handleChange.bind(Object(k.a)(s)),s.handleChangeSearch=s.handleChangeSearch.bind(Object(k.a)(s)),s.handleChangeFile=s.handleChangeFile.bind(Object(k.a)(s)),s.handleSubmit=s.handleSubmit.bind(Object(k.a)(s)),s.checkEnter=s.checkEnter.bind(Object(k.a)(s)),s.myRef=n.a.createRef(),s}return Object(l.a)(a,[{key:"checkEnter",value:function(){var e=Object(S.a)(y.a.mark((function e(t){var a;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(13!==t.keyCode){e.next=18;break}if(this.setState({writeError:null}),""==this.state.content.trim()&&0==this.state.listFile.length){e.next=17;break}return e.prev=3,a={content:this.state.content,timestamp:Date.now(),from_uid:this.state.user.user_id,to_uid:this.state.conver_user.user_id},0!=this.state.listFile.length&&(a.attach_files=this.state.listFile),e.next=8,m.ref("chats").push(a);case 8:this.setState({content:""}),this.setState({listFile:[]}),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(3),this.setState({writeError:e.t0.message});case 15:e.next=18;break;case 17:alert("Nh\u1eadp ch\u1eef v\xe0o dkm !!!");case 18:case"end":return e.stop()}}),e,this,[[3,12]])})));return function(t){return e.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){var e=Object(S.a)(y.a.mark((function e(){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this._isMounted=!1;case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"loadApp",value:function(e){var t=this,a=this.myRef.current;m.ref("users").once("value",(function(s){var n=[],r=s.val();for(var c in r){var i=r[c];i.user_id=c,n.push(i)}t.setState({users:n}),m.ref("chats").once("value",(function(s){var r=[];s.forEach((function(e){var a=e.val();a.from_uid!=t.state.user.user_id&&a.to_uid!=t.state.user.user_id||r.push(a)})),r.sort((function(e,t){return t.timestamp-e.timestamp}));var c,i=[];if(r.forEach((function(e){if(e.from_uid==t.state.user.user_id){if(!i.find((function(t){return t.user_id==e.to_uid}))){var a=n.find((function(t){return t.user_id==e.to_uid}));"undefined"!=typeof a&&(a.last_msg=e.timestamp,i.push(a))}}else if(!i.find((function(t){return t.user_id==e.from_uid}))){var s=n.find((function(t){return t.user_id==e.from_uid}));"undefined"!=typeof s&&(s.last_msg=e.timestamp,i.push(s))}})),t.setState({listUser:i}),r.length&&e){c=r[0].from_uid==t.state.user.user_id?r[0].to_uid:r[0].from_uid,r.sort((function(e,t){return e.timestamp-t.timestamp}));var l=n.filter((function(e){return e.user_id==c}));t.setState({conver_user:l[0]})}r.sort((function(e,t){return e.timestamp-t.timestamp})),t.setState({chats:r}),null!=a&&setTimeout((function(){a.scrollBy(0,a.scrollHeight)}),0),t.setState({loadingChats:!1}),A(t)}))}))}},{key:"componentDidMount",value:function(){var e=Object(S.a)(y.a.mark((function e(){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this._isMounted=!0,I()(document).ready((function(){I()("#action_menu_btn").click((function(){I()(".action_menu").toggle()}))})),this.setState({readError:null,loadingChats:!0}),E(this.props.user.user_id);try{this.loadApp(!0),U(this)}catch(t){this.setState({readError:t.message,loadingChats:!1})}case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"handleChange",value:function(e){this.setState({content:e.target.value})}},{key:"handleSubmit",value:function(){var e=Object(S.a)(y.a.mark((function e(t){var a;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),this.setState({writeError:null}),""==this.state.content.trim()&&0==this.state.listFile.length){e.next=18;break}return e.prev=3,a={content:this.state.content,timestamp:Date.now(),from_uid:this.state.user.user_id,to_uid:this.state.conver_user.user_id},0!=this.state.listFile.length&&(a.attach_files=this.state.listFile),console.log(a),e.next=9,m.ref("chats").push(a);case 9:this.setState({content:""}),this.setState({listFile:[]}),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(3),this.setState({writeError:e.t0.message});case 16:e.next=19;break;case 18:alert("Nh\u1eadp ch\u1eef v\xe0o dkm!!!!");case 19:case"end":return e.stop()}}),e,this,[[3,13]])})));return function(t){return e.apply(this,arguments)}}()},{key:"formatTime",value:function(e){var t=new Date(e);return"".concat(t.getDate(),"/").concat(t.getMonth()+1,"/").concat(t.getFullYear()," ").concat(t.getHours(),":").concat(t.getMinutes())}},{key:"renderElementLoading",value:function(){return this.state.loadingChats?Object(v.jsx)("div",{className:"spinner-border text-success",role:"status",children:Object(v.jsx)("span",{className:"sr-only",children:"Loading..."})}):null}},{key:"hanldeSwitchConversation",value:function(e){this.setState({conver_user:e})}},{key:"handleChangeSearch",value:function(e){this.setState({search:e.target.value})}},{key:"uploadFiles",value:function(e){for(var t=this,a=new FormData,s=e.length,n=0;n<s;n++)a.append("files",e[n]);C.a.post("http://localhost:4500/uploads",a,{onUploadProgress:function(e){var a=Math.round(e.loaded/e.total*100);t.setState({processing:a})}}).then((function(e){t.setState({processing:0});var a=e.data;if(a.length){var s=[];a.forEach((function(e){1!=e.error?s.push(e):alert(e.msg)})),t.setState({listFile:s})}else 1!=a.error?t.setState({listFile:[a]}):alert(a.msg)})).catch((function(e){return console.log(e)}))}},{key:"handleChangeFile",value:function(e){var t=e.target.files;0!=t.length&&(!function(e,t,a){for(var s=e.length,n=0;n<s;n++)if(-1===a.indexOf(e[n][t]))return!1;return!0}(t,"type",["image/png","image/jpg","image/jpeg","image/svg"])?alert("Ch\u1ec9 \u0111\u01b0\u1ee3c g\u1eedi file \u1ea3nh !!!!"):this.uploadFiles(t))}},{key:"removeImageUploadPreview",value:function(e){this.state.listFile.splice(e,1),this.setState({listFile:this.state.listFile})}},{key:"renderUser",value:function(e,t,a){return-1!==e.username.indexOf(a)?Object(v.jsxs)("div",{className:"list__search",onClick:this.hanldeSwitchConversation.bind(this,e),children:[Object(v.jsx)("div",{className:"search__avatar",children:Object(v.jsx)("img",{src:e.profile_picture,alt:""})}),Object(v.jsxs)("div",{className:"search__info",children:[Object(v.jsx)("span",{className:"info__name",children:e.username}),Object(v.jsx)("span",{className:"info__status "+(e.logged?"online":"offline"),children:e.logged?"online":"offline"})]})]},t):null}},{key:"render",value:function(){var e=this;return Object(v.jsxs)("div",{children:[Object(v.jsx)(x,{user_id:this.state.user.user_id}),this.renderElementLoading(),Object(v.jsx)("div",{className:"container-fluid chat-page h-100",children:Object(v.jsxs)("div",{className:"row justify-content-center h-100",children:[Object(v.jsx)("div",{className:"col-md-4 col-xl-3 chat",children:Object(v.jsxs)("div",{className:"card mb-sm-3 mb-md-0 contacts_card",children:[Object(v.jsx)("div",{className:"card-header",children:Object(v.jsxs)("div",{className:"input-group",children:[Object(v.jsx)("input",{type:"text",placeholder:"Search...",onChange:this.handleChangeSearch,value:this.state.search,className:"form-control search"}),Object(v.jsx)("div",{className:"input-group-prepend",children:Object(v.jsx)("span",{className:"input-group-text search_btn",children:Object(v.jsx)("i",{className:"fas fa-search"})})}),""!==this.state.search?Object(v.jsxs)("div",{className:"box__search",children:[Object(v.jsx)("h3",{className:"title__search",children:"Discover"}),Object(v.jsx)("div",{className:"warpper__search",children:this.state.users.map((function(t,a){return e.renderUser(t,a,e.state.search)}))})]}):""]})}),Object(v.jsx)("div",{className:"card-body contacts_body",children:Object(v.jsx)("ul",{className:"contacts",children:this.state.listUser.map((function(t,a){return Object(v.jsx)("li",{className:"list__user "+(t.user_id==e.state.conver_user.user_id?"active":""),onClick:e.hanldeSwitchConversation.bind(e,t),children:Object(v.jsxs)("div",{className:"d-flex bd-highlight",children:[Object(v.jsxs)("div",{className:"img_cont",children:[Object(v.jsx)("img",{src:t.profile_picture,className:"rounded-circle user_img"}),Object(v.jsx)("span",{className:"online_icon "+(t.logged?"":"offline")})]}),Object(v.jsxs)("div",{className:"user_info",children:[Object(v.jsx)("span",{children:t.username}),t.logged?"":Object(v.jsxs)("p",{children:["left ",e.formatTime(t.last_online)]})]})]})},a)}))})}),Object(v.jsx)("div",{className:"card-footer"})]})}),Object(v.jsx)("div",{className:"col-md-8 col-xl-6 chat",children:Object(v.jsxs)("div",{className:"card",children:[Object(v.jsxs)("div",{className:"card-header msg_head",children:[Object(v.jsxs)("div",{className:"d-flex bd-highlight",children:[Object(v.jsxs)("div",{className:"img_cont",children:[Object(v.jsx)("img",{src:this.state.conver_user.profile_picture,className:"rounded-circle user_img"}),Object(v.jsx)("span",{className:"online_icon"+(this.state.conver_user.logged?"":"offline")})]}),Object(v.jsx)("div",{className:"user_info",children:Object(v.jsx)("span",{children:this.state.conver_user.username})}),Object(v.jsxs)("div",{className:"video_cam",children:[Object(v.jsx)("span",{children:Object(v.jsx)("i",{className:"fas fa-video"})}),Object(v.jsx)("span",{children:Object(v.jsx)("i",{className:"fas fa-phone"})})]})]}),Object(v.jsx)("span",{id:"action_menu_btn",children:Object(v.jsx)("i",{className:"fas fa-ellipsis-v"})}),Object(v.jsx)("div",{className:"action_menu",children:Object(v.jsxs)("ul",{children:[Object(v.jsxs)("li",{children:[Object(v.jsx)("i",{className:"fas fa-user-circle"})," View profile"]}),Object(v.jsxs)("li",{children:[Object(v.jsx)("i",{className:"fas fa-users"})," Add to close friends"]}),Object(v.jsxs)("li",{children:[Object(v.jsx)("i",{className:"fas fa-plus"})," Add to group"]}),Object(v.jsxs)("li",{children:[Object(v.jsx)("i",{className:"fas fa-ban"})," Block"]})]})})]}),Object(v.jsx)("div",{className:"card-body msg_card_body",ref:this.myRef,children:this.state.chats.map((function(t,a){if(t.from_uid==e.state.conver_user.user_id&&t.to_uid==e.state.user.user_id||t.to_uid==e.state.conver_user.user_id&&t.from_uid==e.state.user.user_id)return Object(v.jsxs)("div",{className:"d-flex "+(t.from_uid==e.state.conver_user.user_id?"justify-content-start":"justify-content-end")+" mb-4",children:[Object(v.jsx)("div",{className:"img_cont_msg",children:Object(v.jsx)("img",{src:t.from_uid==e.state.conver_user.user_id?e.state.conver_user.profile_picture:e.state.user.profile_picture,className:"rounded-circle user_img_msg"})}),Object(v.jsx)("div",{className:"image_cotainer",children:t.attach_files?Object(v.jsxs)("div",{className:"message__image",children:[t.attach_files.map((function(e,t){return Object(v.jsx)("img",{className:"image_attach",src:e.path,alt:""},t)})),""==t.content?Object(v.jsx)("span",{className:"msg_time_image",children:e.formatTime(t.timestamp)}):""]}):""}),""!=t.content?Object(v.jsxs)("div",{className:"msg_cotainer",children:[t.content,Object(v.jsx)("span",{className:"msg_time",children:e.formatTime(t.timestamp)})]}):""]},a)}))}),Object(v.jsx)("div",{className:"card-footer",children:Object(v.jsx)("form",{onSubmit:this.handleSubmit,children:Object(v.jsxs)("div",{className:"input-group",children:[Object(v.jsx)("div",{className:"list__upload",children:this.state.listFile.map((function(t,a){return Object(v.jsxs)("div",{title:t.name,className:"image__upload",children:[Object(v.jsx)("img",{className:"image__preview",src:t.path}),Object(v.jsx)("span",{onClick:e.removeImageUploadPreview.bind(e,a),className:"remove__btn",children:"x"})]},a)}))}),Object(v.jsx)("div",{className:"input-group-append",children:Object(v.jsxs)("label",{className:"input-group-text attach_btn",children:[Object(v.jsx)("i",{className:"fas fa-paperclip"}),Object(v.jsx)("input",{onChange:this.handleChangeFile,className:"hidden__field",multiple:!0,type:"file"})]})}),Object(v.jsxs)("div",{className:"message__field",children:[this.state.processing>0?Object(v.jsx)("div",{style:{width:this.state.processing+"%"},className:"process_bar"}):"",Object(v.jsx)("textarea",{onKeyUp:this.checkEnter,onChange:this.handleChange,value:this.state.content,className:"form-control type_msg",placeholder:"Type your message..."})]}),Object(v.jsx)("div",{className:"input-group-append",children:Object(v.jsx)("button",{type:"submit",children:Object(v.jsx)("span",{className:"input-group-text send_btn",children:Object(v.jsx)("i",{className:"fas fa-location-arrow"})})})})]})})})]})})]})}),Object(v.jsxs)("div",{className:"py-5 mx-3",children:["Login in as: ",Object(v.jsx)("strong",{className:"text-info",children:this.state.user.email})]})]})}}]),a}(s.Component),P=a(23);function L(){var e=new b.GoogleAuthProvider;return b().signInWithPopup(e)}function M(){var e=new b.GithubAuthProvider;return b().signInWithPopup(e)}var T=function(e){Object(o.a)(a,e);var t=Object(u.a)(a);function a(){var e;return Object(i.a)(this,a),(e=t.call(this)).state={error:null,email:"",password:""},e.handleChange=e.handleChange.bind(Object(k.a)(e)),e.handleSubmit=e.handleSubmit.bind(Object(k.a)(e)),e.googleSignIn=e.googleSignIn.bind(Object(k.a)(e)),e.githubSignIn=e.githubSignIn.bind(Object(k.a)(e)),e}return Object(l.a)(a,[{key:"handleChange",value:function(e){this.setState(Object(P.a)({},e.target.name,e.target.value))}},{key:"handleSubmit",value:function(){var e=Object(S.a)(y.a.mark((function e(t){var a;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),this.setState({error:""}),e.prev=2,e.next=5,s=this.state.email,n=this.state.password,b().createUserWithEmailAndPassword(s,n);case 5:a=e.sent,console.log(a),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),this.setState({error:e.t0.message});case 12:case"end":return e.stop()}var s,n}),e,this,[[2,9]])})));return function(t){return e.apply(this,arguments)}}()},{key:"googleSignIn",value:function(){var e=Object(S.a)(y.a.mark((function e(){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,L();case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),this.setState({error:e.t0.message});case 8:case"end":return e.stop()}}),e,this,[[0,5]])})));return function(){return e.apply(this,arguments)}}()},{key:"githubSignIn",value:function(){var e=Object(S.a)(y.a.mark((function e(){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,M();case 3:e.next=9;break;case 5:e.prev=5,e.t0=e.catch(0),console.log(e.t0),this.setState({error:e.t0.message});case 9:case"end":return e.stop()}}),e,this,[[0,5]])})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return Object(v.jsx)("div",{className:"container",children:Object(v.jsxs)("form",{className:"mt-5 py-5 px-5",onSubmit:this.handleSubmit,children:[Object(v.jsxs)("h1",{children:["Sign Up to",Object(v.jsx)(g.b,{className:"title ml-2",to:"/",children:"Chatty"})]}),Object(v.jsx)("p",{className:"lead",children:"Fill in the form below to create an account."}),Object(v.jsx)("div",{className:"form-group",children:Object(v.jsx)("input",{className:"form-control",placeholder:"Email",name:"email",type:"email",onChange:this.handleChange,value:this.state.email})}),Object(v.jsx)("div",{className:"form-group",children:Object(v.jsx)("input",{className:"form-control",placeholder:"Password",name:"password",onChange:this.handleChange,value:this.state.password,type:"password"})}),Object(v.jsxs)("div",{className:"form-group",children:[this.state.error?Object(v.jsx)("p",{className:"text-danger",children:this.state.error}):null,Object(v.jsx)("button",{className:"btn btn-primary px-5",type:"submit",children:"Sign up"})]}),Object(v.jsx)("p",{children:"You can also sign up with any of these services"}),Object(v.jsx)("button",{className:"btn btn-danger mr-2",type:"button",onClick:this.googleSignIn,children:"Sign up with Google"}),Object(v.jsx)("button",{className:"btn btn-secondary",type:"button",onClick:this.githubSignIn,children:"Sign up with GitHub"}),Object(v.jsx)("hr",{}),Object(v.jsxs)("p",{children:["Already have an account? ",Object(v.jsx)(g.b,{to:"/login",children:"Login"})]})]})})}}]),a}(s.Component),B=function(e){Object(o.a)(a,e);var t=Object(u.a)(a);function a(){var e;return Object(i.a)(this,a),(e=t.call(this)).state={error:null,email:"",password:""},e.handleChange=e.handleChange.bind(Object(k.a)(e)),e.handleSubmit=e.handleSubmit.bind(Object(k.a)(e)),e.googleSignIn=e.googleSignIn.bind(Object(k.a)(e)),e.githubSignIn=e.githubSignIn.bind(Object(k.a)(e)),e}return Object(l.a)(a,[{key:"handleChange",value:function(e){this.setState(Object(P.a)({},e.target.name,e.target.value))}},{key:"handleSubmit",value:function(){var e=Object(S.a)(y.a.mark((function e(t){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),this.setState({error:""}),e.prev=2,e.next=5,a=this.state.email,s=this.state.password,b().signInWithEmailAndPassword(a,s);case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(2),this.setState({error:e.t0.message});case 10:case"end":return e.stop()}var a,s}),e,this,[[2,7]])})));return function(t){return e.apply(this,arguments)}}()},{key:"googleSignIn",value:function(){var e=Object(S.a)(y.a.mark((function e(){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,L();case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),this.setState({error:e.t0.message});case 8:case"end":return e.stop()}}),e,this,[[0,5]])})));return function(){return e.apply(this,arguments)}}()},{key:"githubSignIn",value:function(){var e=Object(S.a)(y.a.mark((function e(){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,M();case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),this.setState({error:e.t0.message});case 8:case"end":return e.stop()}}),e,this,[[0,5]])})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return Object(v.jsx)("div",{className:"container",children:Object(v.jsxs)("form",{className:"mt-5 py-5 px-5",autoComplete:"off",onSubmit:this.handleSubmit,children:[Object(v.jsxs)("h1",{children:["Login to",Object(v.jsx)(g.b,{className:"title ml-2",to:"/",children:"Chatty"})]}),Object(v.jsx)("p",{className:"lead",children:"Fill in the form below to login to your account."}),Object(v.jsx)("div",{className:"form-group",children:Object(v.jsx)("input",{className:"form-control",placeholder:"Email",name:"email",type:"email",onChange:this.handleChange,value:this.state.email})}),Object(v.jsx)("div",{className:"form-group",children:Object(v.jsx)("input",{className:"form-control",placeholder:"Password",name:"password",onChange:this.handleChange,value:this.state.password,type:"password"})}),Object(v.jsxs)("div",{className:"form-group",children:[this.state.error?Object(v.jsx)("p",{className:"text-danger",children:this.state.error}):null,Object(v.jsx)("button",{className:"btn btn-primary px-5",type:"submit",children:"Login"})]}),Object(v.jsx)("p",{children:"You can also log in with any of these services"}),Object(v.jsx)("button",{className:"btn btn-danger mr-2",type:"button",onClick:this.googleSignIn,children:"Sign in with Google"}),Object(v.jsx)("button",{className:"btn btn-secondary",type:"button",onClick:this.githubSignIn,children:"Sign in with GitHub"}),Object(v.jsx)("hr",{}),Object(v.jsxs)("p",{children:["Don't have an account? ",Object(v.jsx)(g.b,{to:"/signup",children:"Sign up"})]})]})})}}]),a}(s.Component);a(79);function R(e){var t=e.component,a=e.authenticated,s=Object(d.a)(e,["component","authenticated"]);return Object(v.jsx)(f.b,Object(h.a)(Object(h.a)({},s),{},{render:function(e){return!0===a?Object(v.jsx)(t,Object(h.a)({user:s.user},e)):Object(v.jsx)(f.a,{to:{pathname:"/login",state:{from:e.location}}})}}))}function W(e){var t=e.component,a=e.authenticated,s=Object(d.a)(e,["component","authenticated"]);return Object(v.jsx)(f.b,Object(h.a)(Object(h.a)({},s),{},{render:function(e){return!1===a?Object(v.jsx)(t,Object(h.a)({},e)):Object(v.jsx)(f.a,{to:"/chat"})}}))}var G=function(e){Object(o.a)(a,e);var t=Object(u.a)(a);function a(){var e;return Object(i.a)(this,a),(e=t.call(this)).state={authenticated:!1,loading:!0},e}return Object(l.a)(a,[{key:"render",value:function(){return!0===this.state.loading?Object(v.jsx)("h2",{children:"Loading..."}):Object(v.jsx)(g.a,{children:Object(v.jsxs)(f.d,{children:[Object(v.jsx)(f.b,{exact:!0,path:"/nbchat1",component:_}),Object(v.jsx)(R,{path:"/chat",authenticated:this.state.authenticated,component:D,user:this.state.user}),Object(v.jsx)(W,{path:"/signup",authenticated:this.state.authenticated,component:T}),Object(v.jsx)(W,{path:"/login",authenticated:this.state.authenticated,component:B})]})})}},{key:"componentDidMount",value:function(){var e=this;b().onAuthStateChanged((function(t){if(t){var a=t.email,s=[];m.ref("users").on("value",(function(n){var r=n.val();for(var c in r){var i=r[c];i.user_id=c,s.push(i)}var l=null;s.forEach((function(e){e.email==a&&(l=e)})),null==l&&function(e,t,a){m.ref("users").push({username:t,email:e,profile_picture:a})}(a,t.displayName,t.photoURL),e.setState({authenticated:!0,loading:!1,user:l})}))}else e.setState({authenticated:!1,loading:!1})}))}}]),a}(s.Component),H=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,81)).then((function(t){var a=t.getCLS,s=t.getFID,n=t.getFCP,r=t.getLCP,c=t.getTTFB;a(e),s(e),n(e),r(e),c(e)}))};c.a.render(Object(v.jsx)(n.a.StrictMode,{children:Object(v.jsx)(G,{})}),document.getElementById("root")),H()}},[[80,1,2]]]);
//# sourceMappingURL=main.f6c6b0af.chunk.js.map